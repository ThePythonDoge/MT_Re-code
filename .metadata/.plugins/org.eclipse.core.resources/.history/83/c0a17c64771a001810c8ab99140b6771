package com.mortuusterra.listeners;

import org.bukkit.Material;
import org.bukkit.block.Block;
import org.bukkit.block.BlockFace;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerInteractEvent;

import com.mortuusterra.MortuusTerraMain;
import com.mortuusterra.managers.MTGeck;

public class MTGeckListener implements Listener {

	private MortuusTerraMain main;

	public MTGeckListener(MortuusTerraMain m) {
		this.main = m;
	}

	@EventHandler
	public void onInteract(PlayerInteractEvent e) {
		// is the clicked block a lever
		if (e.getClickedBlock().getType().equals(Material.LEVER)) {
			Block lever = e.getClickedBlock();
			// is the block below the lever a sponge
			if (lever.getRelative(BlockFace.DOWN).getType().equals(Material.SPONGE)) {
				Block sponge = lever.getRelative(BlockFace.DOWN);
				BlockFace[] faces = { BlockFace.EAST, BlockFace.WEST, BlockFace.NORTH, BlockFace.SOUTH };
				for (BlockFace f : faces) {
					// are there pistons on the 4 horizontal sides of the sponge
					if (sponge.getRelative(f).getType().equals(Material.PISTON_BASE)) {
						// TODO: is there a generator in range.
						if(main.getRad().containsGeck(geck))
						main.getRad().addGeck(new MTGeck(sponge.getLocation()));
					}
				}
			}
		}
	}

}
